# Energine PHP 8 Edition

Модернизированная версия CMS Energine, адаптированная под современный стек PHP и фронтенда. Репозиторий основан на релизе Energine 2.11.4, но полностью перенастроен на PHP 8.4+, Composer и обновлённые практики разработки, сохраняя совместимость с оригинальным API.

## Что внутри
- **Совместимость с ядром 2.11.4.** Содержит оригинальные модули, XSLT-шаблоны и структуру каталогов Energine.
- **Переосмысленный bootstrap.** Класс `App\\Bootstrap\\EnergineBootstrapper` и фронт-контроллер `index.php` переписаны на строгие типы, интегрирован Composer autoload и обработчик ошибок Whoops.
- **Интеграция современных библиотек.** Предустановлены PHP-DI, Monolog, Symfony Cache/Translation/Validator/HttpFoundation, Doctrine DBAL — всё конфигурируется через `system.config.php`.
- **ES6-клиент без Mootools.** Панель управления и служебные интерфейсы используют нативные ES6-классы вместо устаревшего Mootools.
- **Автоматическое обслуживание кеша изображений.** Сервис `ImageService` по расписанию очищает устаревшие файлы в кеше.

## Ключевые отличия от классического Energine
1. Требования повышены до **PHP 8.4+** и Composer-first подхода вместо поставляемого вместе vendor-кода.
2. Старт проекта контролируется через строгие точки входа, а не процедурные `bootstrap.php`/`index.php` из ветки 2.11.x.
3. Инфраструктура логирования, DI, кеширования и БД переключена на популярные OSS-пакеты, поддерживающие PSR-стандарты.
4. Клиентский код административных модулей написан на ES6, что устраняет зависимость от Mootools и упрощает расширение.
5. Добавлены вспомогательные маршруты (например, health-check) на базе Symfony HttpFoundation для интеграции с оркестраторами.

## Преимущества
- **Готовность к продакшену.** Современный стек PHP/JS, поддержка OPCache, возможность быстро подключить Redis/APCu.
- **Управляемая инфраструктура.** DI-контейнер, Monolog и Symfony Cache позволяют централизованно управлять зависимостями.
- **Снижение технического долга.** ES6-модули, composer autoload и строгие типы облегчают поддержку и статический анализ.
- **Совместимость с наследием.** Остаются доступными шаблоны, модули и API оригинальной Energine для постепенной миграции.

## Структура проекта
- `engine/` — ядро Energine (форк оригинального репозитория).
- `app/` — пользовательские сервисы, маршрутизаторы и расширения (`App\\` namespace).
- `site/` — бизнес-логика и шаблоны конкретного проекта.
- `setup/` — мастер установки и миграции.
- `docs/` — дополнительная документация (UI-фреймворки, статический анализ и др.).

## Системные требования
- PHP 8.4+ с включённым `ext-opcache`.
- Composer 2.x.
- Драйверы БД и кэша по необходимости (MySQL/PostgreSQL, Redis, APCu и т. д.).

## Быстрый старт
1. Установите зависимости: `composer install`.
2. Скопируйте и настройте `system.config.php`, указав пути к ядру, сайту, базе данных и опциональным сервисам.
3. Запустите установщик через веб-интерфейс `/setup` или CLI: `php index.php setup`.
4. Проверьте служебные маршруты (например, health-check), настроенные через `App\\Routing\\Router`.
5. Соберите и подключите фронтенд-ассеты в соответствии с инструкциями из `docs/ui-frameworks.md` (опционально).

## Полезные команды
- `composer phpstan` — базовая статическая проверка.
- `composer phpstan:dead-code` — углублённый анализ мёртвого кода.

---

Проект предназначен для команд, которым нужно сохранить совместимость с Energine 2.11.x, но перейти на современный стек PHP и инструменты разработки.
