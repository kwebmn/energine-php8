# Setup 2 — руководство по запуску и интеграции

## Требования

* PHP 8.3 или новее с поддержкой CLI и веб-SAPI.
* Установленные расширения: opcache, pdo, mbstring, json, curl, openssl, dom, SimpleXML, fileinfo. Необязательные, но рекомендованные: intl, zip, gd.
* Доступ к Composer для установки зависимостей проекта (`vendor/autoload.php` обязателен для запуска установщика).

## Подготовка окружения

1. Клонируйте репозиторий и перейдите в корневую директорию проекта.
2. Установите зависимости:
   ```bash
   composer install
   ```
3. Проверьте права на запись для директорий, с которыми работает установщик. Они должны существовать (или иметь возможность быть созданными) и быть доступны на запись пользователю, под которым запускается PHP:
   * `var/`
   * `var/cache/`
   * `var/log/`
   * `var/export/`
   * `uploads/`
   * `uploads/public/`
   * `uploads/temp/`

   Если каталоги отсутствуют, их можно создать и выдать права командой вида:
   ```bash
   mkdir -p var/cache var/log var/export uploads/public uploads/temp
   chmod -R 775 var uploads
   ```

## Использование CLI-интерфейса

1. Выполните команду проверке окружения (пример):
   ```bash
   php setup2/cli.php checkEnv
   ```
   Допустимо использовать как `checkEnv`, так и `check-env`. Скрипт вернёт статус и детализированную информацию о проверках.
2. Для запуска других действий подставьте нужное имя из списка доступных (установщик поддерживает `install`, `clear-cache`, `sync-uploads`, `export-trans`, `uninstall`, `check-env`).

## Веб-интерфейс

1. При необходимости включите Basic Auth, задав переменные окружения перед запуском сервера:
   ```bash
   export SETUP2_USER="admin"
   export SETUP2_PASS="secret"
   ```
2. Запустите встроенный PHP-сервер из корня проекта:
   ```bash
   php -S 127.0.0.1:8000 setup2/web.php
   ```
   Альтернативно настройте любой веб-сервер (Nginx/Apache), направив его на `setup2/web.php`.
3. Откройте `http://127.0.0.1:8000` в браузере. Если Basic Auth включён, авторизуйтесь, используя логин и пароль из переменных окружения.
4. На панели «Действия» выберите нужную задачу. После запуска результат и лог отобразятся в правом блоке. Все формы защищены CSRF-токеном, повторный запуск возможен сразу после завершения предыдущего действия.

## Проверка готовности

Для подтверждения готовности к интеграции выполните:

1. CLI-проверку окружения (см. выше) — все обязательные пункты должны пройти без ошибок.
2. Тестовый запуск через веб-интерфейс (например, `Check Env`) и убедитесь, что лог успешно отображается.

После этого Setup 2 готов к дальнейшей интеграции или развертыванию.
